# =============================================================================
# Kitty Configuration - Ported from WezTerm
# =============================================================================
# This config mirrors the WezTerm setup from wezterm/my_own_tmux.lua
# Key features: tmux-like multiplexing with Ctrl+number for tabs, splits, etc.

# =============================================================================
# FONT SETTINGS
# =============================================================================
font_family      Berkeley Mono
# font_family      Berkeley Mono Bold
# font_family      Ubuntu Mono
#font_family      Iosevka Bold
# font_family      JetBrains Mono 
font_size        12.0
#modify_font cell_height 130%
modify_font cell_height 120%
adjust_cell_width 100%
font_features Berkeley Mono
# modify_font cell_height 110%
# modify_font cell_height 100%

# Font rendering - Load monitor-specific settings
# To switch between monitors, use one of these commands:
#   export KITTY_MONITOR=retina && kitty  (for MacBook built-in display)
#   export KITTY_MONITOR=external && kitty  (for external FullHD monitor)
# Or use the included configs directly

# Default to retina (built-in display) settings
# Change this line to include font-rendering-retina.conf for external monitor
include font-rendering-retina.conf

# Disable ligatures if needed (uncomment to disable)
# disable_ligatures always

# =============================================================================
# CURSOR SETTINGS
# =============================================================================
cursor_shape          block
cursor_blink_interval 0
cursor_stop_blinking_after 0
# Cursor color (wood_light from MHFU theme)
cursor #b89060
cursor_text_color #1a1816

# Cursor trail (cool visual effect)
#cursor_trail 3
#cursor_trail_decay 0.1 0.3
#cursor_trail_start_threshold 2

# =============================================================================
# SCROLLBACK
# =============================================================================
scrollback_lines 10000

# Use nvim for scrollback - gives full vim visual mode (v, V, Ctrl+v)
# Based on justinmk's (neovim core) recommendation
# q to quit, full vim keybindings for selection and yanking
scrollback_pager nvim --cmd 'set eventignore=FileType' +'nnoremap q ZQ' +'call nvim_open_term(0, {})' +'set nomodified nolist nonumber norelativenumber signcolumn=no' +'$' -

# =============================================================================
# MOUSE
# =============================================================================
mouse_hide_wait 3.0
copy_on_select  clipboard
strip_trailing_spaces smart

# =============================================================================
# TERMINAL BELL
# =============================================================================
enable_audio_bell no
visual_bell_duration 0.0

# =============================================================================
# WINDOW LAYOUT
# =============================================================================
#remember_window_size  no
#initial_window_width  120c
#initial_window_height 35c

window_padding_width 10

# Window decorations
hide_window_decorations titlebar-only
confirm_os_window_close 1

# macOS specific
macos_option_as_alt yes
macos_quit_when_last_window_closed no
macos_window_resizable yes
macos_show_window_title_in none
macos_titlebar_color background

# Background opacity
#background_opacity 0.95
#background_blur 20

# Pane/split border colors (MHFU Pokke Village)
active_border_color   #6a5040
inactive_border_color #2a2520

# =============================================================================
# COLOR SCHEME - MHFU Pokke Village (ported from WezTerm)
# =============================================================================
# Based on Monster Hunter Freedom Unite â€“ Pokke Village colorscheme

# Backgrounds: warm wood tones
background #1a1816
# background #1F2129
# Foregrounds: parchment/cream text
foreground #d4c8b0

# Selection
selection_background #2E3838
selection_foreground #d4c8b0

# URL color
url_color #6a8a9a

# ANSI Colors
# black (wood)
color0  #22201c
# red (well-done steak)
color1  #a85a5a
# green (health bar)
color2  #7a9a6a
# yellow (stamina bar)
color3  #c4a860
color4  #6a8a9a
# blue (quest menu)
# magenta (rare item)
color5  #8a7090
# cyan (pokke snow)
color6  #8a9aa8
# white (parchment)
color7  #d4c8b0

# Bright colors
# bright black (wood dark)
color8  #6a5040
# bright red (felyne kitchen)
color9  #b8864a
# bright green
color10 #8aaa7a
# bright yellow (wood highlight)
color11 #b89060
# bright blue
color12 #7a9ab0
# bright magenta
color13 #9a80a0
# bright cyan (ice)
color14 #a0a8b0
# bright white (lighter parchment)
color15 #e4d8c0

# =============================================================================
# TAB BAR
# =============================================================================
tab_bar_edge bottom
tab_bar_style custom
tab_powerline_style slanted
tab_bar_min_tabs 1
tab_bar_margin_width 10
tab_bar_margin_height 12 12
tab_bar_align center

# Filter tabs by session - only show tabs from active session
tab_bar_filter session:~ or session:^$

# Tab colors (MHFU Pokke Village warm wood tones)
active_tab_foreground   #e4d8c0
active_tab_background   #9a7050
active_tab_font_style   bold
inactive_tab_foreground #9a8a70
inactive_tab_background #2a2520
inactive_tab_font_style normal
tab_bar_background      #1a1816

# Tab title template
tab_title_template      "{index}: {title}"
active_tab_title_template "{index}: {title}"

# =============================================================================
# LAYOUTS - Enable splits layout for pane management
# =============================================================================
enabled_layouts splits,stack,tall,fat,grid,horizontal,vertical

# =============================================================================
# KEYBOARD SHORTCUTS
# =============================================================================
# Clear all default shortcuts first (optional - uncomment to start fresh)
# clear_all_shortcuts yes

# Use Ctrl as the main modifier (tmux-like)
# kitty_mod is ctrl+shift by default, but we'll define custom shortcuts

# -----------------------------------------------------------------------------
# TAB SWITCHING - Ctrl+1 through Ctrl+9 (PRIORITY FEATURE)
# -----------------------------------------------------------------------------
map ctrl+1 goto_tab 1
map ctrl+2 goto_tab 2
map ctrl+3 goto_tab 3
map ctrl+4 goto_tab 4
map ctrl+5 goto_tab 5
map ctrl+6 goto_tab 6
map ctrl+7 goto_tab 7
map ctrl+8 goto_tab 8
map ctrl+9 goto_tab 9

# -----------------------------------------------------------------------------
# SPLITS / PANES (PRIORITY FEATURE)
# -----------------------------------------------------------------------------
# Ctrl+/ - Split horizontal (side by side) - matches WezTerm
map ctrl+/ launch --location=vsplit --cwd=current
map ctrl+\ launch --location=vsplit --cwd=current

# Ctrl+Alt+- - Split vertical (stacked) - matches WezTerm
# Note: ctrl+- and ctrl+= reserved for font size on Linux
map ctrl+alt+minus launch --location=hsplit --cwd=current

# -----------------------------------------------------------------------------
# PANE NAVIGATION - Ctrl+h/j/k/l (vim-style)
# -----------------------------------------------------------------------------
map ctrl+h neighboring_window left
map ctrl+j neighboring_window down
map ctrl+k neighboring_window up
map ctrl+l neighboring_window right

# -----------------------------------------------------------------------------
# TAB MANAGEMENT
# -----------------------------------------------------------------------------
# Ctrl+n - New tab (matches WezTerm)
map ctrl+n new_tab_with_cwd

# Ctrl+Shift+o - New tab with opencode in current directory
map ctrl+shift+o launch --type=tab --cwd=current opencode .

# Ctrl+x - Close pane/window (matches WezTerm)
map ctrl+x close_window

# Ctrl+w - Rotate/swap panes (matches WezTerm's rotate)
map ctrl+w move_window_forward
map ctrl+shift+w move_window_backward

# Ctrl+z - Toggle zoom (matches WezTerm)
map ctrl+z toggle_layout stack

# Ctrl+r - Rename tab
map ctrl+r set_tab_title

# -----------------------------------------------------------------------------
# COPY MODE (vim-style visual mode via nvim)
# -----------------------------------------------------------------------------
# Ctrl+v - Enter vim-style scrollback mode with full visual selection
# Use v/V/Ctrl+v for visual modes, y to yank, q to quit
map ctrl+v show_scrollback

# Ctrl+shift+v - Paste from clipboard (standard)
map ctrl+shift+v paste_from_clipboard

# Ctrl+space - Quick word hints (pick words with keyboard)
# map ctrl+space kitten hints --type=word --program=@

# -----------------------------------------------------------------------------
# HINTS KITTEN - Interactive screen element picker
# -----------------------------------------------------------------------------
# Ctrl+Shift+h - URL hints (open in browser)
map ctrl+shift+h kitten hints

# Ctrl+Shift+h variants via sequences
map ctrl+shift+h>u kitten hints --type=url
map ctrl+shift+h>p kitten hints --type=path --program=@
map ctrl+shift+h>h kitten hints --type=hash --program=@
map ctrl+shift+h>l kitten hints --type=line --program=@
map ctrl+shift+h>n kitten hints --type=linenum
map ctrl+shift+h>w kitten hints --type=word --program=@
map ctrl+shift+h>i kitten hints --type=ip --program=@

# -----------------------------------------------------------------------------
# WORKSPACE-LIKE FEATURES
# Not directly supported in Kitty like WezTerm workspaces,
# but we can use OS windows and tabs
# -----------------------------------------------------------------------------
# Ctrl+shift+p - New OS window with quick naming (launch with title)
map ctrl+shift+p launch --type=os-window --cwd=current

# Ctrl+i - Show window info
map ctrl+i show_kitty_env_vars

# Ctrl+shift+r - Set window title (workspace rename equivalent)
map ctrl+shift+r set_window_title

# -----------------------------------------------------------------------------
# SESSION/PROJECT SWITCHING
# -----------------------------------------------------------------------------
# Ctrl+shift+f - Sessionizer: pick project directory, create/switch to its session
map ctrl+shift+f launch --type=overlay ~/.dotfiles/config/scripts/kitty-sessionizer.sh

# Ctrl+shift+s - Switch between sessions (fzf picker)
map ctrl+shift+s launch --type=overlay ~/.dotfiles/config/scripts/kitty-session-switcher.sh

# Ctrl+shift+d - Delete sessions
map ctrl+shift+d launch --type=overlay ~/.dotfiles/config/scripts/kitty-session-deleter.sh

# -----------------------------------------------------------------------------
# ADDITIONAL USEFUL SHORTCUTS
# -----------------------------------------------------------------------------
# Font size adjustments
map ctrl+plus change_font_size all +1.0
map ctrl+equal change_font_size all +1.0
map ctrl+minus change_font_size all -1.0
map ctrl+kp_add change_font_size all +1.0
map ctrl+kp_subtract change_font_size all -1.0
map ctrl+0 change_font_size all 0

# Reload config
map ctrl+shift+f5 load_config_file

# Command palette equivalent (using Kitty's action alias)
map cmd+shift+p kitten hints --type linenum

# Paste (ctrl+shift+v defined in COPY MODE section above)
map cmd+v paste_from_clipboard

# Copy
map ctrl+shift+c copy_to_clipboard
map cmd+c copy_to_clipboard

# Scroll
map ctrl+shift+up scroll_line_up
map ctrl+shift+down scroll_line_down
map ctrl+shift+page_up scroll_page_up
map ctrl+shift+page_down scroll_page_down
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end

# -----------------------------------------------------------------------------
# WINDOW RESIZING
# -----------------------------------------------------------------------------
# Arrow keys
map ctrl+left resize_window narrower 3
map ctrl+right resize_window wider 3
map ctrl+up resize_window taller 3
map ctrl+down resize_window shorter 3
map ctrl+shift+home resize_window reset

# Alt+Shift+h/j/k/l for resizing (vim-style, avoids conflict with Polish Å‚)
map alt+shift+h resize_window narrower 3
map alt+shift+l resize_window wider 3
map alt+shift+j resize_window shorter 3
map alt+shift+k resize_window taller 3

# =============================================================================
# ADVANCED SETTINGS
# =============================================================================
allow_remote_control yes
listen_on unix:/tmp/kitty
shell_integration enabled
#term xterm-256color

# Update check
update_check_interval 0

# Bell
window_alert_on_bell yes
bell_on_tab " ðŸ””"
